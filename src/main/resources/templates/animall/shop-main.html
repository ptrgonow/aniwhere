<!DOCTYPE html>
<div th:replace="~{include/header :: header}"></div>
<link rel="stylesheet" href="/css/shop-main.css">
<body>
<!--PreLoader Ends-->
<div class="breadcrumb-section breadcrumb-bg">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 text-center">
                <div class="breadcrumb-text">
                    <p>반려동물 용품</p>
                    <h1>AniMall</h1>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- products -->
<div class="product-section mt-150 mb-150">
    <div class="container">

        <!-- 새로운 div 내의 독립적 버튼들 -->
        <div class="row">
            <div class="col-md-12">
                <div class="view-toggle-buttons">
                    <button class="btn btn-outline-primary toggle-view grid-view"><i class="fas fa-th"></i> </button>
                    <button class="btn btn-outline-primary toggle-view list-view"><i class="fas fa-list"></i> </button>
                </div>
            </div>
        </div>
        <div class="col-md-12">
            <div class="product-filters">
                <ul>
                    <li class="active" data-category="all">전체</li>
                    <li data-category="dog">강아지</li>
                    <li data-category="cat">고양이</li>
                    <li data-category="others">기타</li>
                </ul>
            </div>
        </div>

        <div id="product-container" class="row product-lists">
            <div th:each="product : ${products}" class="col-lg-4 col-md-6 text-center">
                <div class="single-product-item">
                    <div class="product-image">
                        <a><img th:src="${product.image}" alt="외부 이미지"></a>
                    </div>
                    <div class="product-details">
                        <h3 th:text="${product.name}">상품 이름</h3>
                        <div class="product-price">
                            <p th:text="${product.price}"></p>원
                        </div>
                    </div>
                    <a class="cart-btn"><i class="fas fa-shopping-cart"></i> Add to Cart</a>
                </div>
            </div>
        </div>

        <div id="pagination-container">
        </div>

    </div>
</div>

<div class="scroll-buttons">
    <button id="scroll-up" onclick="scrollToTop()">▲</button>
    <button id="scroll-down" onclick="scrollToBottom()">▼</button>
</div>

<div th:replace="~{include/footer :: footer}"></div>
<script th:inline="javascript">

    document.addEventListener('DOMContentLoaded', function () {
        const paginationContainer = document.getElementById('pagination-container');

        const currentPage = parseInt(/*[[${currentPage}]]*/);
        const totalPages = parseInt(/*[[${totalPages}]]*/);

        const rangeSize = 9;
        const currentRangeStart = Math.floor((currentPage - 1) / rangeSize) * rangeSize + 1;
        const currentRangeEnd = Math.min(currentRangeStart + rangeSize - 1, totalPages);

        function createPaginationLinks() {
            let links = '';
            if (currentRangeStart > 1) {
                links += `<a href="/shop/main?page=${currentRangeStart - rangeSize}&size=9" class="page-link">&laquo;</a>`;
            }
            for (let i = currentRangeStart; i <= currentRangeEnd; i++) {
                links += `<a href="/shop/main?page=${i}&size=9" class="page-link ${i === currentPage ? 'active' : ''}">${i}</a>`;
            }
            if (currentRangeEnd < totalPages) {
                links += `<a href="/shop/main?page=${currentRangeStart + rangeSize}&size=9" class="page-link">&raquo;</a>`;
            }
            paginationContainer.innerHTML = links;
        }

        createPaginationLinks();
    });
</script>\
</body>

